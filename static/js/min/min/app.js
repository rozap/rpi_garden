require.config({baseUrl:"/static/js/",shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"},d3:{exports:"d3"},rickshaw:{deps:["d3"],exports:"rickshaw"}},paths:{jquery:"libs/jquery",underscore:"libs/underscore",backbone:"libs/backbone",d3:"libs/d3",rickshaw:"libs/rickshaw"}}),require(["underscore","backbone","rickshaw","collections","models","text!templates/chart.html","text!templates/state.html"],function(e,t,i,s,r,n,a){var l={dispatcher:e.clone(t.Events)};setInterval(function(){l.dispatcher.trigger("fetchNewData")},12e4);var h=t.View.extend({width:800,height:400,template:e.template(n),events:{"click .next-btn":"nextPage","click .prev-btn":"prevPage"},initialize:function(){this.collection=new this.series([],l),this.listenTo(this.collection,"sync",this.render),this.collection.fetch()},adaptData:function(){var e=this;return[{color:e.color,name:e.yName,data:this.collection.map(function(t){return{x:t.get(e.xName),y:t.get(e.yName)}})}]},render:function(){this.$el.html(this.template({id:this.$el.attr("id"),title:this.title,hasNext:this.collection.hasNext.bind(this.collection),hasPrev:this.collection.hasPrev.bind(this.collection)})),console.log($(this.$el.attr("id")+"-chart")[0]),this._graph=new i.Graph({element:$("#"+this.$el.attr("id")+"-chart")[0],renderer:"area",series:this.adaptData()}),new Rickshaw.Graph.Axis.Time({graph:this._graph}),new Rickshaw.Graph.Axis.Y({graph:this._graph,orientation:"left",width:80,tickFormat:Rickshaw.Fixtures.Number.formatKMBT,element:$("#"+this.$el.attr("id")+"chart-y-axis")[0]}),new Rickshaw.Graph.HoverDetail({graph:this._graph,xFormatter:this.formatX.bind(this),yFormatter:this.formatY.bind(this)}),this._graph.render()},formatX:function(e){return new Date(1e3*e)+" "+(this.xUnits||this.xName)},formatY:function(e){return e+" "+(this.yUnits||this.yName)},nextPage:function(){this.collection.next()},prevPage:function(){this.collection.prev()}}),o=h.extend({title:"ph",el:"#ph-view",xName:"time",yName:"ph",series:s.PHCollection,color:"#A9C388"}),c=h.extend({title:"Temperature",el:"#temp-view",xName:"time",yName:"temp",yUnits:"degrees",series:s.TempCollection,color:"#F54551"}),m=h.extend({title:"Water level",el:"#level-view",xName:"time",yName:"level",yUnits:"inches",series:s.LevelCollection,color:"#015A61"}),d=t.View.extend({el:"#state-view",template:e.template(a),initialize:function(){this.model=new r.State({},l),this.listenTo(this.model,"sync",this.render),this.model.fetch(),this._interval=setInterval(this.model.fetch.bind(this.model),3e3)},render:function(){return this.$el.html(this.template({model:this.model.toJSON()})),this}});new o,new c,new m,new d,console.info("hello world")});